
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Gulp im Rakefile - Sebastian Blei</title>
  <meta name="author" content="Sebastian Blei">

  
  <meta name="description" content="Da mein Blog nicht ganz so ressourcensparend ist, wie ich das gern möchte, habe ich darüber nachgedacht, einen (node) Taskrunner im Workflow zu &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">

  
  <link rel="canonical" href="http://blei.in/blog/2014/07/01/gulp-im-rakefile">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Sebastian Blei" type="application/atom+xml">
  <!-- <script src="/javascripts/octopress.js" type="text/javascript"></script> -->
  

  <!-- 
 -->
</head>

<body   >
  <header role="banner"><div class="head">
  <a href="/">
    <a href="/about/index.html">
    <div class="ueber">Über mich</div>
</a>

<a href="/"><svg viewBox="0 -5 81 77" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
<!-- <svg width="81px" height="77px" viewBox="0 -5 81 77" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"> -->
    <title>b</title>
    <defs></defs>
    <g id="b" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
        <path d="M21.08,5.192 L21.08,3.464 L32.24,0.728 L32.24,23.264 C35.648017,19.663982 39.4399791,17.864 43.616,17.864 C47.4560192,17.864 50.6119876,19.3759849 53.084,22.4 C55.5560124,25.4240151 56.792,29.3599758 56.792,34.208 C56.792,40.5440317 55.1000169,45.4279828 51.716,48.86 C48.3319831,52.2920172 44.2640238,54.008 39.512,54.008 C36.2959839,54.008 33.1040158,53.312007 29.936,51.92 L27.92,54.008 L26.336,54.008 L26.336,5.84 L21.08,5.192 Z M32.24,49.04 C34.640012,51.0080098 37.2319861,51.992 40.016,51.992 C43.0400151,51.992 45.5959896,50.6000139 47.684,47.816 C49.7720104,45.0319861 50.816,41.4560218 50.816,37.088 C50.816,32.5759774 49.8920092,28.9760134 48.044,26.288 C46.1959908,23.5999866 43.6400163,22.256 40.376,22.256 C37.4959856,22.256 34.7840127,23.5279873 32.24,26.072 C32.24,26.072 34.7840127,23.5279873 32.24,26.072 L32.24,49.04 Z M32.24,49.04" 
            id="b-60deg" 
            opacity="0.5" 
            fill="#31DCB5" 
            sketch:type="MSShapeGroup" 
            transform="rotate(-20 41 37)"
            >
                <animateTransform
                    attributeName="transform"
                    begin="0.7s"
                    type="rotate"
                    values="-20 41 37; -40 41 37; 360 41 37; 330 41 37; 345 41 37; 340 41 37"
                    calcMode="spline"
                    keyTimes="0;.15;.65;0.85;0.92;1"
                    keySplines=".4 0 .6 1; .4 0 .6 1; .4 0 .6 1; .4 0 .6 1; 0 0 1 1"
                    dur="1.41s"
                    repeatCount="1"
                    />
                <animate
                    attributeName="opacity"
                    begin="0.7s"
                    dur=".81s"
                    values="0.5;0;0.5"
                    calcMode="spline"
                    keySplines="0 .5 1 1;.5 0 1 1"
                    />
        </path>

        <path d="M21.08,5.192 L21.08,3.464 L32.24,0.728 L32.24,23.264 C35.648017,19.663982 39.4399791,17.864 43.616,17.864 C47.4560192,17.864 50.6119876,19.3759849 53.084,22.4 C55.5560124,25.4240151 56.792,29.3599758 56.792,34.208 C56.792,40.5440317 55.1000169,45.4279828 51.716,48.86 C48.3319831,52.2920172 44.2640238,54.008 39.512,54.008 C36.2959839,54.008 33.1040158,53.312007 29.936,51.92 L27.92,54.008 L26.336,54.008 L26.336,5.84 L21.08,5.192 Z M32.24,49.04 C34.640012,51.0080098 37.2319861,51.992 40.016,51.992 C43.0400151,51.992 45.5959896,50.6000139 47.684,47.816 C49.7720104,45.0319861 50.816,41.4560218 50.816,37.088 C50.816,32.5759774 49.8920092,28.9760134 48.044,26.288 C46.1959908,23.5999866 43.6400163,22.256 40.376,22.256 C37.4959856,22.256 34.7840127,23.5279873 32.24,26.072 C32.24,26.072 34.7840127,23.5279873 32.24,26.072 L32.24,49.04 Z M32.24,49.04" 
            id="b-120deg" 
            opacity="0.5" 
            fill="#357CA6" 
            sketch:type="MSShapeGroup" 
            transform="rotate(-10 41 37)"
            >
                <animateTransform
                    attributeName="transform"
                    begin="0.6s"
                    type="rotate"
                    values="-10 41 37; -30 41 37; 370 41 37; 340 41 37; 355 41 37; 350 41 37"
                    calcMode="spline"
                    keyTimes="0;.15;.65;0.85;0.92;1"
                    keySplines=".4 0 .6 1; .4 0 .6 1; .4 0 .6 1; .4 0 .6 1; 0 0 1 1"
                    dur="1.41s"
                    repeatCount="1"
                    />
                <animate
                    attributeName="opacity"
                    begin="0.6s"
                    dur="0.81s"
                    values="0.5;0;0.5"
                    calcMode="spline"
                    keySplines="0 .5 1 1;.5 0 1 1"
                    />
        </path>

        <path d="M21.08,5.192 L21.08,3.464 L32.24,0.728 L32.24,23.264 C35.648017,19.663982 39.4399791,17.864 43.616,17.864 C47.4560192,17.864 50.6119876,19.3759849 53.084,22.4 C55.5560124,25.4240151 56.792,29.3599758 56.792,34.208 C56.792,40.5440317 55.1000169,45.4279828 51.716,48.86 C48.3319831,52.2920172 44.2640238,54.008 39.512,54.008 C36.2959839,54.008 33.1040158,53.312007 29.936,51.92 L27.92,54.008 L26.336,54.008 L26.336,5.84 L21.08,5.192 Z M32.24,49.04 C34.640012,51.0080098 37.2319861,51.992 40.016,51.992 C43.0400151,51.992 45.5959896,50.6000139 47.684,47.816 C49.7720104,45.0319861 50.816,41.4560218 50.816,37.088 C50.816,32.5759774 49.8920092,28.9760134 48.044,26.288 C46.1959908,23.5999866 43.6400163,22.256 40.376,22.256 C37.4959856,22.256 34.7840127,23.5279873 32.24,26.072 C32.24,26.072 34.7840127,23.5279873 32.24,26.072 L32.24,49.04 Z M32.24,49.04" 
            id="b-180deg" 
            opacity="0.5" 
            fill="#AD2938" 
            sketch:type="MSShapeGroup" 
            transform=" rotate(10 41 37)"
            >
                <animateTransform
                    attributeName="transform"
                    begin="0.5s"
                    type="rotate"
                    values="10 41 37; -10 41 37; 390 41 37; 360 41 37; 375 41 37; 370 41 37"
                    calcMode="spline"
                    keyTimes="0;.15;.65;0.85;0.92;1"
                    keySplines=".4 0 .6 1; .4 0 .6 1; .4 0 .6 1; .4 0 .6 1; 0 0 1 1"
                    dur="1.41s"
                    repeatCount="1"
                    />
                <animate
                    attributeName="opacity"
                    begin="0.5s"
                    dur="0.81s"
                    values="0.5;0;0.5"
                    calcMode="spline"
                    keySplines="0 .5 1 1;.5 0 1 1"
                    />
        </path>

        <path d="M21.08,5.192 L21.08,3.464 L32.24,0.728 L32.24,23.264 C35.648017,19.663982 39.4399791,17.864 43.616,17.864 C47.4560192,17.864 50.6119876,19.3759849 53.084,22.4 C55.5560124,25.4240151 56.792,29.3599758 56.792,34.208 C56.792,40.5440317 55.1000169,45.4279828 51.716,48.86 C48.3319831,52.2920172 44.2640238,54.008 39.512,54.008 C36.2959839,54.008 33.1040158,53.312007 29.936,51.92 L27.92,54.008 L26.336,54.008 L26.336,5.84 L21.08,5.192 Z M32.24,49.04 C34.640012,51.0080098 37.2319861,51.992 40.016,51.992 C43.0400151,51.992 45.5959896,50.6000139 47.684,47.816 C49.7720104,45.0319861 50.816,41.4560218 50.816,37.088 C50.816,32.5759774 49.8920092,28.9760134 48.044,26.288 C46.1959908,23.5999866 43.6400163,22.256 40.376,22.256 C37.4959856,22.256 34.7840127,23.5279873 32.24,26.072 C32.24,26.072 34.7840127,23.5279873 32.24,26.072 L32.24,49.04 Z M32.24,49.04" 
            id="b-240deg" 
            opacity="0.5" 
            fill="#F89614" 
            sketch:type="MSShapeGroup" 
            transform="rotate(20 41 37)"
            >
                <animateTransform
                    attributeName="transform"
                    begin="0.4s"
                    type="rotate"
                    values="20 41 37; 0 41 37; 400 41 37; 370 41 37; 385 41 37; 380 41 37"
                    calcMode="spline"
                    keyTimes="0;.15;.65;0.85;0.92;1"
                    keySplines=".4 0 .6 1; .4 0 .6 1; .4 0 .6 1; .4 0 .6 1; 0 0 1 1"
                    dur="1.41s"
                    repeatCount="1"
                    />
                <animate
                    attributeName="opacity"
                    begin="0.4s"
                    dur="0.81s"
                    values="0.5;0;0.5"
                    calcMode="spline"
                    keySplines="0 .5 1 1;.5 0 1 1"
                    />
                </path>

        <path d="M21.08,5.192 L21.08,3.464 L32.24,0.728 L32.24,23.264 C35.648017,19.663982 39.4399791,17.864 43.616,17.864 C47.4560192,17.864 50.6119876,19.3759849 53.084,22.4 C55.5560124,25.4240151 56.792,29.3599758 56.792,34.208 C56.792,40.5440317 55.1000169,45.4279828 51.716,48.86 C48.3319831,52.2920172 44.2640238,54.008 39.512,54.008 C36.2959839,54.008 33.1040158,53.312007 29.936,51.92 L27.92,54.008 L26.336,54.008 L26.336,5.84 L21.08,5.192 Z M32.24,49.04 C34.640012,51.0080098 37.2319861,51.992 40.016,51.992 C43.0400151,51.992 45.5959896,50.6000139 47.684,47.816 C49.7720104,45.0319861 50.816,41.4560218 50.816,37.088 C50.816,32.5759774 49.8920092,28.9760134 48.044,26.288 C46.1959908,23.5999866 43.6400163,22.256 40.376,22.256 C37.4959856,22.256 34.7840127,23.5279873 32.24,26.072 C32.24,26.072 34.7840127,23.5279873 32.24,26.072 L32.24,49.04 Z M32.24,49.04" 
            id="b-300deg" 
            opacity="0.5" 
            fill="#FAE309" 
            sketch:type="MSShapeGroup" 
            transform="rotate(30 41 37)"
            >
                <animateTransform
                    attributeName="transform"
                    begin="0.3s"
                    type="rotate"
                    values="30 41 37; 10 41 37; 410 41 37; 380 41 37; 395 41 37; 390 41 37"
                    calcMode="spline"
                    keyTimes="0;.15;.65;0.85;0.92;1"
                    keySplines=".4 0 .6 1; .4 0 .6 1; .4 0 .6 1; .4 0 .6 1; 0 0 1 1"
                    dur="1.41s"
                    repeatCount="1"
                    />
                <animate
                    attributeName="opacity"
                    begin="0.3s"
                    dur="0.81s"
                    values="0.5;0;0.5"
                    calcMode="spline"
                    keySplines="0 .5 1 1;.5 0 1 1"
                    />
        </path>

        <path d="M21.08,5.192 L21.08,3.464 L32.24,0.728 L32.24,23.264 C35.648017,19.663982 39.4399791,17.864 43.616,17.864 C47.4560192,17.864 50.6119876,19.3759849 53.084,22.4 C55.5560124,25.4240151 56.792,29.3599758 56.792,34.208 C56.792,40.5440317 55.1000169,45.4279828 51.716,48.86 C48.3319831,52.2920172 44.2640238,54.008 39.512,54.008 C36.2959839,54.008 33.1040158,53.312007 29.936,51.92 L27.92,54.008 L26.336,54.008 L26.336,5.84 L21.08,5.192 Z M32.24,49.04 C34.640012,51.0080098 37.2319861,51.992 40.016,51.992 C43.0400151,51.992 45.5959896,50.6000139 47.684,47.816 C49.7720104,45.0319861 50.816,41.4560218 50.816,37.088 C50.816,32.5759774 49.8920092,28.9760134 48.044,26.288 C46.1959908,23.5999866 43.6400163,22.256 40.376,22.256 C37.4959856,22.256 34.7840127,23.5279873 32.24,26.072 C32.24,26.072 34.7840127,23.5279873 32.24,26.072 L32.24,49.04 Z M32.24,49.04" 
            id="b" 
            fill="#2A3140" 
            sketch:type="MSShapeGroup"
            transform="">
        </path>
    </g>
</svg></a>
  </a>
    <!-- <div class="round">
      b
    </div> -->
</div></header>
  <!-- <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blei.in" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav> -->
  <div id="main">
    <div id="content">
      <div class="pre-article">
  <article class="hentry" role="article">
    
  <header>
    
      <h1 class="entry-title">Gulp Im Rakefile</h1>
    
    
    
  </header>


<div class="entry-content"><p>Da mein Blog nicht ganz so ressourcensparend ist, wie ich das gern möchte, habe ich darüber nachgedacht, einen <em>(<a href="http://nodejs.org/">node</a>)</em> Taskrunner im Workflow zu integrieren.</p>

<!-- more -->


<p>Wie man ja sieht, ist mein Blog statisch. Den ganzen Rahmen setzt <a href="http://octopress.org/">Octopress</a>, das <a href="https://github.com/iamsebastian/Octopress-Theme-Colerif">Theme</a> hatte ich als <a href="https://github.com/Shopify/liquid">Liquid</a>-Template-Grundgerüst zusammen gesetzt und dann so lange modifziert, bis die Inhalte gepasst haben. Anschließend habe ich eine große Portion <a href="http://sass-lang.org">SASS</a> <em>darauf geworfen</em> und nun sieht der Blog seit einer Weile aus, wie er eben aussieht. Um möglichst wenig Requests zu haben, schickte ich mich bereits damals an, das Template komplett um zu biegen. Die ganzen unnötigen Bibliotheken, wie jQuery, flogen raus und das <a href="https://github.com/iamsebastian/iamsebastian.github.io/blob/master/javascripts/github.js">GitHub-Plugin</a> habe ich so weit runter gebrochen, dass es nicht viel mehr macht, als einen async. Call und das ankommende JSON in den DOM zu parsen.</p>

<p>Leider habe ich keine Möglichkeit gefunden, den GET an die GitHub <a href="https://developer.github.com/v3/">API</a> weiter zu restriktieren, so, dass weniger Daten ankommen würden. Einzig die Anzahl der übermittelten Repository-Informationen lässt sich begrenzen. Im Moment sind das bei mir vier. Die größe des Requests <em>(rein der Body)</em> ließ sich so von ~ 55KB auf ~ 24KB runter brechen, was immerhin eine Ersparnis von ~ 55% ist. Lieber würde ich allerdings das JSON der API-Antwort auf Name, URL und Beschreibung einschränken, was dann nicht viel mehr als 15% Restverkehr bedeuten würde.</p>

<p>So komme ich zu dem Punkt, wo ich weiter an der Performanceschraube drehen kann &ndash; nämlich den anderen Requests. In dem Moment, als ich noch nichts weiter gemacht habe, hatte ich bei <a href="http://developers.google.com/speed/pagespeed/insights/"><em>Googles Pagespeed Insights</em></a> einen Score von 86 / 100.</p>

<p>Was mir spontan vorschwebte, war das Konkatieren von HTML und CSS <em>&ndash; wenn es geht natürlich auch JS</em>. Da meine Ruby-Kenntnisse zwar auf dem Vormarsch sind, aber noch lange nicht die Reife meiner JS Kenntnisse haben, hatte ich die Wahl zwischen Grunt und Gulp. Grunt hatte ich in einem Anderthalb-Quartals-Projekt zwischen den Jahren 2013 und 2014 verwendet und war keineswegs abgetan. Allerdings verwende ich im aktuellen Projekt Gulp, weswegen die Wahl auf eben diesen Taskrunner fiel.</p>

<p>Bei Octopress ist das <em>Rakefile</em> so aufgebaut, dass man zum <em>Generien</em> des Contents, <code>rake generate</code> aufruft und zum Deployen auf GitHub <code>rake deploy</code> &ndash; voraus gesetzt, alles ist entsprechend konifiguriert. Es würde sich also Anbieten, Gulp entsprechend <em>zwischen den Zeilen</em> zu platzieren. Aufgerufen würde das über <code>system "gulp"</code> im Rakefile, wenn sich die <code>gulpfile.js</code> im selben Verzeichnis befindet, wie das Rakefile. <em>system</em> ist <a href="http://ruby-doc.org/core-2.1.2/Kernel.html#method-i-system">eine Implementierung</a> im ruby core, die den Kernel des Systems ansteuert &ndash; oder zumindest das, was die Virtual Machine davon übrig lässt. <em>system</em> gibt einen Bool <em>(true)</em>, entsprechend des exit code des aktuellen Aufrufes, zurück. Ruby, respektive, das Rakefile, wartet mit der Abarbeitung der Aufrufe, bis der jeweilige Prozess abgeschlossen ist. Daher sollte es kein Problem darstellen, <em>gulp</em> zwischen <em>generate</em> und <em>deploy</em> auf zu rufen.</p>

<p>Ich rufe den Prozess am Ende des <em>:generate</em> Tasks auf:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">task</span> <span class="ss">:generate</span> <span class="k">do</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="nb">system</span> <span class="s2">&quot;compass compile --css-dir </span><span class="si">#{</span><span class="n">source_dir</span><span class="si">}</span><span class="s2">/stylesheets&quot;</span>
</span><span class='line'>  <span class="nb">system</span> <span class="s2">&quot;jekyll&quot;</span>
</span><span class='line'>  <span class="nb">system</span> <span class="s2">&quot;gulp&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>gulpfile.js</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span><span class='line'><span class="cm">/* global require */</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">dir</span> <span class="o">=</span> <span class="s1">&#39;public&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">paths</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">dest</span><span class="o">:</span> <span class="nx">dir</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">css</span><span class="o">:</span> <span class="nx">dir</span> <span class="o">+</span> <span class="s1">&#39;/stylesheets/screen.css&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">html</span><span class="o">:</span> <span class="nx">dir</span> <span class="o">+</span> <span class="s1">&#39;/index.html&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">js</span><span class="o">:</span> <span class="nx">dir</span> <span class="o">+</span> <span class="s1">&#39;/javascripts/github.js&#39;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">),</span>
</span><span class='line'>    <span class="nx">gulp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp&#39;</span><span class="p">),</span>
</span><span class='line'>    <span class="nx">replace</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp-replace&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;replace-css&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">html</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;link(.*)screen.css(.*)&gt;/</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">_file</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">css</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="s1">&#39;&lt;style&gt;\n&#39;</span> <span class="o">+</span> <span class="nx">_file</span> <span class="o">+</span> <span class="s1">&#39;\n&lt;/style&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}))</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">dest</span><span class="p">));</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;replace-js&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">html</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;script(.*)github.js(.*)(&gt;.*&gt;)/</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">_file</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">js</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="s1">&#39;&lt;script&gt;\n&#39;</span> <span class="o">+</span> <span class="nx">_file</span> <span class="o">+</span> <span class="s1">&#39;\n&lt;/script&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}))</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">dest</span><span class="p">));</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;replace-css&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">gulp</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="s1">&#39;replace-js&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;replace&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Der Task ist nun vollständig im Workflow integriert, macht also keine zusätzliche Arbeit mehr und erspart mir zwei HTTP Requests. Bleiben also &ndash; voraus gesetzt die Fonts sind schon geladen &ndash; nur noch zwei Requests übrig: HTML inkl. Stylesheet und der GET Request an GitHub. Das <em>Inlinen</em> der Javascript-Datei sollte man allerdings nur vornehmen, wenn sie nicht blockiert, sie also nur eine kurze Rechenzeit braucht oder asynchron arbeitet.</p>
</div>


    <footer>
      <p class="meta">
        
  

<p><span class="byline author vcard">von <span class="fn">Sebastian Blei</span></span></p>

        








  


<time datetime="2014-07-01T17:09:00+02:00" pubdate data-updated="true"> 1 July 2014</time>
        

<p>
  <span class="categories">
    
      in <a class='category' href='/blog/categories/gulp/'>gulp</a>, <a class='category' href='/blog/categories/rake/'>rake</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>, <a class='category' href='/blog/categories/taskrunner/'>taskrunner</a>
    
  </span>
</p>


      </p>
      
        <div class="sharing">
  
  
  
</div>

      
      <p class="meta">
        
          Vorheriger Artikel: <a class="basic-alignment left" href="/blog/2014/03/07/git-log-filter/" title="Previous Post: git log Filter">&laquo; git log Filter</a>
        
        
        
      </p>
    </footer>
  </article>
  
</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/07/01/gulp-im-rakefile/">Gulp Im Rakefile</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/07/git-log-filter/">Git Log Filter</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/06/git-log-formatieren/">Git Log Formatieren</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/06/git-log/">Git Log Ausgaben</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/12/dynamische-scrollcontainer/">Dynamische Scrollcontainer</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/iamsebastian">@iamsebastian</a> on GitHub
  
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded',function(){
        // if (!window.jXHR){
        //     var jxhr = document.createElement('script');
        //     jxhr.type = 'text/javascript';
        //     jxhr.src = '/javascripts/libs/jXHR.js';
        //     var s = document.getElementsByTagName('script')[0];
        //     s.parentNode.insertBefore(jxhr, s);
        // }

        github.showRepos({
            user: 'iamsebastian',
            count: 4,
            skip_forks: true,
            per_page: 5,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <div class="clear"></div>
  <footer role="contentinfo"><p>
  <!-- No copyright &copy; 2014 - Sebastian Blei - -->
  Sebastian Blei, 2014.
  </br>MIT License.</br>
  <span class="credit">Unterstützt von <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  










</body>
</html>
